# ფიზიკური პირების ცნობარი

არსებული API საშუალებას აძლევს მომხმარებელს ცნობარში დაამატოს ფიზიკური პირი, მისი პირადი ინფორმაცია(სახელი, გვარი, მისამართი, დაბადების თარიღი, საკონტაქტო ინფორმაცია, სურათი) და დაკავშირებული პირები. კავშირი ორმხრივია, თუ A დაკავშირებულია B-სთან, მაშინ B-ც დაკავშირებულია A-სთან. შეუძლებელია ცნობარში ორ ადამიანს შორის არსებობდეს ერთზე მეტი კავშირი.

# რესურსები:


## 1. ფიზიკური პირების რესურსი: /api/naturalPersons


ამ რესურსით შესაძლებელია ფიზიკური პირის ცნობარში დამატება, მათი სიის მიღება paging და ordering-ის ფუნქციით, მათი ინფორმაციის მიღება უნიკალური Id-ის საშუალებით, ფიზიკური პირის მონაცემების განახლება, წაშლა, აგრეთვე ფოტოს დამატება, შეცვლა და წაშლა.
Request-ის მეთოდები:

**1.1) GET: ფიზიკური პირების სიის მიღება: /api/naturalPersons**


აღნიშნული მეთოდით შეგვიძლია ასევე მივიღოთ დალაგებული სია, ამისთვის query პარამეტრებად უნდა დავუწეროთ შემდეგი პარამეტრებიდან ერთი ან რამდენიმე:

•	pageSize=x აღნიშნული პარამეტრით ვეუბნებით API-ს რომ გვინდა დაგვიბრუნოს მხოლოდ x რაოდენობის მონაცემი

•	pageNumber=y თუ მივუთითეთ pageSize, მაშინ pageNumber პარამეტრით ვეუბნებით API-ს რომ გვინდა იმ სიაში, რომელიც დაგვიბრუნდა და დაიყო page-ბად, დაგვიბრუნოს y page-ზე არსებული მონაცემები

•	orderBy=z აღნიშნული პარამეტრით შეგვიძლია დავალაგოთ მონაცემები რომელიმე property-ის საშუალებით. z-ის დასაშვები მნიშვნელობებია: "NaturalPersonId", "FirstNameEn", "LastNameEn", "PassportNumber", "Birthday"(პირველი სიმბოლო აუცილებლად capital letter უნდა იყოს).


თუ არც ერთი პარამეტრი არ იქნება მითითებული, ავტომატურად მიენიჭება მნიშვნელობები და დაგვიბრუნებს პირველ 10 მონაცემს დალაგებულს უნიკალური Id-ით.
მაგალითად: https://localhost:44336/api/naturalPersons?pageNumber=1&pageSize=2&orderBy=PassportNumber

**1.2) GET : ფიზიკური პირის მიღება მისი უნიკალური Id-ის საშუალებით: /api/naturalPersons/{id}**

მაგალითად: https://localhost:44336/api/naturalPersons/2

**1.3) DELETE: ფიზიკური პირის წაშლა: /api/naturalPersons/{id}**

როდესაც წავშლით ფიზიკურ პირს, ასევე წაიშლება მისი კავშირები (და არა დაკავშირებული პირები)
ქვემოთ არის ორი მეთოდი, რომლებიც საჭიროებენ json-ად request-ის გაგზავნას. რექუესთი გამოიყურება შემდეგნაირად:
{
	"firstNameGE": "სახელი",
	"firstNameEN": "Name",
	"lastNameGe": "გვარი",
	"lastNameEN": "Surname",
	"passportNumber": "33333333333",
	"birthday": "1952-09-16",
	"address": "Address",
	"contactInformations": "+995-555-111-222,name.surname@example.com"
}
ყველა ველი აუცილებელია. 

•	პირადი ნომერი უნდა იყოს 11 ციფრი

•	დაბადების დღე უნდა იყოს შემდეგი ფორმატით: YYYY-MM-DD

•	საკონტაქტო ინფორმაციები უნდა იყოს ერთი სტრინგად, საკონტაქტო ინფორმაციები ერთმანეთისგან გამოყოფილი უნდა მძიმით (,). საკონტაქტო ინფორმაცია უნდა იყოს ან ტელეფონის ნომერი(ფორმატით +995-5XX-XXX-XXX) და ან email.

**1.4) POST: ფიზიკური პირის ცნობარში დამატება: /api/naturalPersons**

ფიზიკური პირი ცნობარში არ დაემატება იმ შემთხვევაში, თუ შეყვანილი პირადი ნომერი უკვე არსებობს ცნობარში.

**1.5) PUT : ფიზიკური პირის განახლება: /api/naturalPersons/{id}**

ფიზიკური პირის მონაცემები იმ შემთხვევაში არ განახლდება, თუ შეყვანილი პირადი ნომერი არ ემთხვევა მის ცნობარში არსებულ პირად ნომერს.

**1.6) GET : ფიზიკურ პირთან დაკავშირებული პირების სიის მიღება: /api/naturalPersons/{id}/relations**

ქვედა ორი მეთოდის რექუესთი უნდა გაიგზავნოს 
/api/naturalPersons/{id}/image -ზე
form-data-ს საშუალებით, Key უნდა იყოს image, Value- ფოტოს ფაილი. დაშვებული გაფართოებები:  .jpg,  .jpeg,  .png, .tiff ,.gif

**1.7) POST : ფოტოს დამატება**

ფოტო დაემატება მაშინ და მხოლოდ მაშინ, როდესაც ამ Id-ის მქონე პირს არ აქვს ფოტო(ImagePath იქნება ცარიელი). ფოტო აიტვირთება შემდეგ მისამართზე: [პროექტის ფოლდერი]\NaturalPersonsDirectory.API\Images. 

**1.8) PUT : ფოტოს განახლება**
ფოტო განახლდება მაშინ და მხოლოდ მაშინ, როდესაც ამ Id-ის მქონე პირს აქვს ფოტო.

**1.9) DELETE : ფოტოს წაშლა: /api/naturalPersons/{id}/image**

ფოტოს წაშლა გულისხმობს მოცემული პირის ImagePath-ის გა-null-ებას. რეალურად არსებული ფოტო არ იშლება და რჩება 1.7-ში აღწერილ მისამართზე
ფოტო წაიშლება მაშინ და მხოლოდ მაშინ, როდესაც ამ Id-ის მქონე პირს აქვს ფოტო, ანუ ImagePath არ არის ცარიელი. 


## 2. კავშირების რესურსი: /api/relations

ამ რესურსის საშუალებით შესაძლებელია ცნობარში დავამატოთ კავშირი ორ პირს შორის. 
Request-ის მეთოდები:

**2.1) GET : კავშირების სიის მიღება**

აღნიშნული მეთოდი აბრუნებს ცნობარში არსებულ ყველა კავშირს, Paging აქაც მუშაობს და default-ად გვიბრუნებს პირველ 10 ჩანაწერს

**2.2) GET : კავშირის მიღება უნიკალური Id-ის საშუალებით**
/api/relations/{id}

**2.3) DELETE : კავშირის წაშლა**
/api/relations/{id}

ქვედა ორ მეთოდს სჭირდება json-ის გაგზავნა რექუესთად. რექუესთი გამოიყურება შემდეგნაირად:
{
    "fromId" : "X",
    "toId" : "Y",
    "relationType" : "[კავშირის ტიპი]"
}
სამივე ველი აუცილებელია. კავშირის ტიპის დასაშვები მნიშვნელობებია: Employee, Relative, Acquaintance, Other (პირველი სიმბოლო აუცილებლად capital-letter უნდა იყოს).

**2.4) POST : კავშირის შექმნა**
კავშირი არ შეიქმნება მაშინ, თუ

•	თუ fromId ან toId ველებში მოცემული Id-ის მქონე პირი არ მოიძებნა

•	თუ fromId და toId ველებში ერთი და იგივე რიცხვი იქნა შეყვანილი

•	თუ უკვე არსებობს კავშირი იმავე FromId და ToId ველებით

•	თუ კავშირის ტიპი არასწორად იქნა მითითებული

**2.5) PUT : კავშირის განახლება**
შესაძლებელია მხოლოდ კავშირის ტიპის შეცვლა. FromId და ToId ველები არ შეიცვლება.

# ლოგირება
ყოველი გაუთვალისწინებელი შეცდომა ილოგება შემდეგ ფაილში: 
**C:\temp\nlog-own-[თარიღი].log**
